<%- include('partials/header') %>

<main class="container mt-5">
  <h2 class="mb-4"><%= event.name %></h2>

  <!-- Event Description -->
  <div class="mb-4">
    <h5>Description</h5>
    <p><%= event.description %></p>
  </div>

  <!-- Event Date and Organizer -->
  <div class="mb-4">
    <h5>Date & Organizer</h5>
    <p><strong>Date:</strong> <%= event.date %></p>
    <p><strong>Organizer:</strong> <%= event.organizer %></p>
  </div>

  <!-- Event Location -->
  <div class="mb-4">
    <h5>Location</h5>
    <p><strong>Venue:</strong> <%= event.location.venue %></p>
    <p><strong>City:</strong> <%= event.location.city %></p>
    <p><strong>State:</strong> <%= event.location.state %></p>
    <p><strong>Country:</strong> <%= event.location.country %></p>
  </div>

  <!-- Event Categories -->
  <div class="mb-4">
    <h5>Categories</h5>
    <ul>
      <% event.categories.forEach(category => { %>
        <li><%= category %></li>
      <% }) %>
    </ul>
  </div>

  <!-- Event Speakers/Performers/Participants/Leaders/Authors -->
  <div class="mb-4">
    <h5>Featured Individuals</h5>
    <ul>
      <% if (event.speakers) { %>
        <% event.speakers.forEach(speaker => { %>
          <li><strong><%= speaker.name %></strong> - <%= speaker.topic %></li>
        <% }) %>
      <% } else if (event.performers) { %>
        <% event.performers.forEach(performer => { %>
          <li><strong><%= performer.name %></strong> - <%= performer.genre %></li>
        <% }) %>
      <% } else if (event.participants) { %>
        <% event.participants.forEach(participant => { %>
          <li><strong><%= participant.name %></strong> - <%= participant.sector %></li>
        <% }) %>
      <% } else if (event.leaders) { %>
        <% event.leaders.forEach(leader => { %>
          <li><strong><%= leader.name %></strong> - <%= leader.style %></li>
        <% }) %>
      <% } else if (event.authors) { %>
        <% event.authors.forEach(author => { %>
          <li><strong><%= author.name %></strong> - <%= author.genre %></li>
        <% }) %>
      <% } %>
    </ul>
  </div>

  <!-- Event Sponsors -->
  <div class="mb-4">
    <h5>Sponsors</h5>
    <ul>
      <% event.sponsors.forEach(sponsor => { %>
        <li><%= sponsor %></li>
      <% }) %>
    </ul>
  </div>

  <!-- Event Schedule -->
  <div class="mb-4">
    <h5>Schedule</h5>
    <ul>
      <% event.schedule.forEach(item => { %>
        <li><strong><%= item.time %>:</strong> <%= item.activity %></li>
      <% }) %>
    </ul>
  </div>

  <!-- Edit and Delete Buttons -->
  <div class="mt-4">
    <button class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#editEventModal">Edit Event</button>
    <form action="/api/events/<%= event.id %>?_method=DELETE" method="POST" class="d-inline">
      <button type="submit" class="btn btn-danger">Delete Event</button>
    </form>
  </div>
</main>

<!-- Edit Event Modal -->
<div class="modal fade" id="editEventModal" tabindex="-1" aria-labelledby="editEventModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="editEventModalLabel">Edit Event</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="editEventForm" method="POST" action="/api/events/<%= event.id %>?_method=PUT">
          <!-- Form fields similar to the add event form -->
          <input type="text" class="form-control" name="name" value="<%= event.name %>" required>
          <textarea class="form-control mt-3" name="description" required><%= event.description %></textarea>
          <input type="date" class="form-control mt-3" name="date" value="<%= event.date %>" required>
          <input type="text" class="form-control mt-3" name="organizer" value="<%= event.organizer %>" required>
          <input type="text" class="form-control mt-3" name="venue" value="<%= event.location.venue %>" required>
          <input type="text" class="form-control mt-3" name="city" value="<%= event.location.city %>" required>
          <input type="text" class="form-control mt-3" name="state" value="<%= event.location.state %>" required>
          <input type="text" class="form-control mt-3" name="country" value="<%= event.location.country %>" required>
          <input type="text" class="form-control mt-3" name="categories" value="<%= event.categories.join(', ') %>" required>
          <input type="text" class="form-control mt-3" name="speakers" value="<%= event.speakers.map(sp => sp.name + ':' + sp.topic).join(', ') %>" required>
          <input type="text" class="form-control mt-3" name="sponsors" value="<%= event.sponsors.join(', ') %>" required>
          <input type="text" class="form-control mt-3" name="schedule" value="<%= event.schedule.map(sch => sch.time + ':' + sch.activity).join(', ') %>" required>
          <button type="submit" class="btn btn-primary mt-3">Save Changes</button>
        </form>
      </div>
    </div>
  </div>
</div>

<%- include('partials/footer') %>
